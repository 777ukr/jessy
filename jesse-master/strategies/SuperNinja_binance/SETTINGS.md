# SuperNinja_binance - Конвертированная стратегия binance из Freqtrade

## Описание

SuperNinja_binance - это конвертированная стратегия из Freqtrade с двумя условиями входа и сложной логикой управления рисками.

### Особенности стратегии

**Два условия входа:**
1. **is_ewo**: Основано на EWO (Elliott Wave Oscillator), RSI и EMA
2. **buy_1**: Основано на RSI, SMA, CTI (Correlation Trend Indicator)

**Управление рисками:**
- Кастомный стоп-лосс с динамической логикой
- Deadfish exit - выход при низкой волатильности и убытке
- Выход по Stochastic Fast при перекупленности

### Используемые индикаторы

- **EWO (Elliott Wave Oscillator)**: EMA 50/200, делится на low (не close!)
- **RSI**: Быстрый (4), обычный (14), медленный (20)
- **EMA**: 8 и 16 периодов
- **SMA**: 15 периодов
- **CTI (Correlation Trend Indicator)**: Корреляция между ценой и временем
- **Stochastic Fast**: Для определения перекупленности
- **Bollinger Bands**: Для определения волатильности и deadfish exit

### ✅ ПРОВЕРЕННЫЕ ДАННЫЕ В БАЗЕ

**Доступные данные:**
- **Период:** 2024-11-01 до 2025-11-07 (год данных)
- **Свечей 1m:** 535,552
- **Все периоды из отчета присутствуют:** 202412, 202501, 202502, 202503, 202504, 202505, 202506, 202507

**Анализ волатильности по месяцам:**
- 202412: диапазон 18.23% (91,517 - 108,199)
- 202501: диапазон 22.50% (89,381 - 109,493)
- 202502: диапазон 31.13% (78,347 - 102,740) ⚠️ самый волатильный
- 202503: диапазон 23.89% (76,598 - 94,894)
- 202504: диапазон 28.15% (74,582 - 95,580)
- 202505: диапазон 19.78% (93,406 - 111,882)
- 202506: диапазон 12.44% (98,288 - 110,517) ✅ наименее волатильный
- 202507: диапазон 17.19% (105,135 - 123,203)

**Общая статистика:**
- Общий диапазон за год: 88.70% (66,805 - 126,064)
- Средняя цена: ~$101,608
- Стандартное отклонение: ~$12,007

### Основные параметры

**Exchange:** Gate USDT Perpetual  
**Symbol:** BTC-USDT  
**Timeframe:** 5m (как в оригинальной стратегии)  
**Leverage:** 1x (cross margin)  
**Starting Balance:** $10,000

### Период тестирования

**Рекомендуемый период:** 2024-12-01 до 2025-07-31 (8 месяцев, как в отчете)

**Или полный год:** 2024-11-01 до 2025-11-07

**Warmup:** 200+ свечей (достаточно данных есть)

### Настройки комиссий

**Fee:** 0.00016 (0.016% - тейкер комиссия Gate.io)

**Примечание:** Gate.io возвращает 60% комиссий на фьючерсах, что улучшит результаты на ~25% от уплаченных комиссий.

### Параметры стратегии

**Вход is_ewo:**
- buy_rsi_fast: 50
- buy_rsi: 30
- buy_ewo: -1.238
- buy_ema_low: 0.956
- buy_ema_high: 0.986

**Вход buy_1:**
- buy_rsi_fast_32: 63
- buy_rsi_32: 16
- buy_sma15_32: 0.932
- buy_cti_32: -0.8

**Выход:**
- sell_fastx: 75 (Stochastic Fast для выхода)
- sell_deadfish_bb_width: 0.05
- sell_deadfish_profit: -0.05
- sell_deadfish_bb_factor: 1.0
- sell_deadfish_volume_factor: 1.0

**Управление рисками:**
- Stop Loss: -99% (базовый, очень широкий)
- Кастомный стоп-лосс активируется динамически:
  - После 60 минут: если fastk > sell_fastx и profit > -1%
  - После 1 дня: если fastk > sell_fastx и profit > -5%
  - Для входа "ewo": если profit >= 5%, стоп на -0.5%
  - Если profit > 0 и fastk > sell_fastx: стоп на -0.1%

### Логика входа

**is_ewo:**
- rsi_fast (4) < 50
- close < ema_8 * 0.956
- EWO > -1.238
- close < ema_16 * 0.986
- rsi (14) < 30

**buy_1:**
- rsi_slow (20) падает (текущий < предыдущий)
- rsi_fast (4) < 63
- rsi (14) > 16
- close < sma_15 * 0.932
- CTI < -0.8

### Логика выхода

**Deadfish Exit:**
- Прибыль < -5%
- BB ширина < 0.05 (низкая волатильность)
- Цена > BB middle * 1.0
- Объем 12 < Объем 24 * 1.0

**Кастомный стоп-лосс:**
- Динамически обновляется в зависимости от времени удержания и условий

### Ожидаемые результаты

На основе оригинальной стратегии binance:
- Стратегия оптимизирована для частых сделок
- Использует широкий стоп-лосс (-99%) с динамической защитой
- Deadfish exit помогает избежать длительных убытков
- Два условия входа увеличивают количество возможных входов

### Отличия от оригинальной стратегии

1. **EWO расчет**: Использует EMA вместо SMA и делит на low вместо close
2. **CTI**: Реализован через корреляцию между ценой и временем
3. **Кастомный стоп-лосс**: Адаптирован для Jesse framework
4. **Deadfish exit**: Реализован через update_position

### Рекомендации

1. Используйте таймфрейм **5m** для лучших результатов
2. Убедитесь, что в базе достаточно данных (минимум 200 свечей для warmup)
3. Стратегия может генерировать много сделок - следите за комиссиями
4. После бектеста используйте калькулятор возврата комиссий для расчета реальной прибыли

### Калькулятор возврата комиссий

```bash
python3 fee_rebate_calculator.py <Total_Paid_Fees> <Net_Profit> <Starting_Balance>
```

Пример:
```bash
python3 fee_rebate_calculator.py 685.40 -595.79 10000
```



